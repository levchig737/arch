GAS LISTING task4.S 			page 1


   1              	/*
   2              		–ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–ª—è –≤—ã—á–µ—Å–ª–µ–Ω–∏—è —Å—É–º–º—ã –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö –æ–¥–Ω–æ—Ü–∏—Ñ—Ä–æ–≤—
   3              		–¢–∞–∫–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏ –∏ —É—á–∏—Ç—ã–≤–∞–µ—Ç –
   4              		–í—ã–≤–æ–¥–∏—Ç —Å—É–º–º—É —á–∏—Å–µ–ª –≤ 10 —Å—Å 8 —Å—Å –∏ 2 —Å—Å
   5              	
   6              		–ê–≤—Ç–æ—Ä: –ß–µ–∫–∞—Ä–µ–≤ –õ–µ–≤ 22107 2022–≥	
   7              	*/
   8              		
   9              	.include "my-macro" 		# –ü–æ–¥–∫–ª—é—á–∞–µ–º —Ñ–∞–π–ª —Å –º–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è–º–∏
   1              	/*
   2              	 * –ú–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã.
   3              	 * –ê—Ä–≥—É–º–µ–Ω—Ç—ã:
   4              	 *     - –∫–æ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã
   5              	 *
   6              	 * –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞ –∏–∑–º–µ–Ω—è—é—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä—ã: %e
   7              	 * –°–º. —Ç–∞–∫–∂–µ 'man 2 exit'
   8              	*/
   9              	.macro Exit ret_val
  10              	    movl $1, %eax         # –Ω–æ–º–µ—Ä —Å–∏—Å—Ç. –≤—ã–∑–æ–≤–∞ exit
  11              	    movl \ret_val, %ebx     # –∫–æ–¥ –≤—ã—Ö–æ–¥–∞
  12              	    int $0x80         # –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤
  13              	.endm
  14              	
  15              	
  16              	/*
  17              	 * –ú–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–ª—è —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è –æ–¥–Ω–æ–≥–æ –±–∞–π—Ç–∞ –∫–æ–¥–∞ —Å
  18              	 * —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –≤–≤–æ–¥–∞
  19              	 * –ê—Ä–≥—É–º–µ–Ω—Ç—ã:
  20              	 *     - –∞–¥—Ä–µ—Å –±—É—Ñ–µ—Ä–∞ –¥–ª—è —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è –±–∞–π—Ç–∞
  21              	 * –†–µ–∑—É–ª—å—Ç–∞—Ç:
  22              	 *    - –≤ %eax –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—á–∏—Ç–∞–Ω–Ω—ã—Ö –±–∞–π—Ç–æ–≤
  23              	 *    - –ø–æ –∞–¥—Ä–µ—Å—É buf_addr - —Å—á–∏—Ç–∞–Ω–Ω—ã–π –±–∞–π—Ç
  24              	 *
  25              	 * –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞ –∏–∑–º–µ–Ω—è—é—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä—ã: %e
  26              	 * –°–º. —Ç–∞–∫–∂–µ 'man 2 read'
  27              	*/
  28              	.macro Getchar buf_addr
  29              	    movl $3, %eax        # –Ω–æ–º–µ—Ä —Å–∏—Å—Ç. –≤—ã–∑–æ–≤–∞ read
  30              	    movl $0, %ebx        # –ø–∞—Ä–∞–º–µ—Ç—Ä 1: –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –≤–≤–æ
  31              	    movl \buf_addr, %ecx    # –ø–∞—Ä–∞–º–µ—Ç—Ä 2: –∞–¥—Ä–µ—Å –±—É—Ñ–µ—Ä–∞ (–æ–Ω –∂–µ - —Ñ–∞–∫—Ç–∏—á
  32              	                     # –ø–∞—Ä–∞–º–µ—Ç—Ä –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞)
  33              	    movl $1, %edx        # –ø–∞—Ä–∞–º–µ—Ç—Ä 3: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç–æ–≤ –¥–ª—è —á—Ç–µ–Ω–∏—
  34              	    int $0x80        # –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤
  35              	.endm
  36              	
  37              	/*
  38              	 * –ú–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–ª—è  –≤—ã–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏ –≤ —Ñ–∞–π–ª —Å—Ç–∞–Ω–¥–∞—Ä—Ç–
  39              	 * –ê—Ä–≥—É–º–µ–Ω—Ç—ã:
  40              	 *     - –°—Ç—Ä–æ–∫–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞.
  41              	 *
  42              	 * –ü—Ä–∏–º–µ—Ç—Ä –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞:
  43              	 *    Puts "–¢–µ–∫—Å—Ç –≤—ã–≤–æ–¥–∏–º–æ–π —Å—Ç—Ä–æ–∫–∏"
  44              	 *
  45              	 * –†–µ–∑—É–ª—å—Ç–∞—Ç:
  46              	 *    - –≤—ã–≤–æ–¥–∏—Ç –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–≤–æ–¥ —Å–∏–º–≤–æ–ª—ã –∑–∞–¥–∞–Ω–Ω–æ–π —Å—Ç—Ä–
  47              	 *      –∏ –≤—Å–ª–µ–¥ –∑–∞ –Ω–∏–º–∏ —Å–∏–º–≤–æ–ª –ø–µ—Ä–µ–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏ \n
  48              	 *
GAS LISTING task4.S 			page 2


  49              	 * –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞ –∏–∑–º–µ–Ω—è—é—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä—ã: %e
  50              	 * –°–º. —Ç–∞–∫–∂–µ 'man puts', 'man 2 write'
  51              	*/
  52              	.macro Puts string
  53              	.data
  54              	    str\@:     .ascii "\string\n"  # —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä–æ–∫–∏ –
  55              	
  56              	    strlen\@ =     . - str\@           # –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª–∏–Ω—ã —Å—Ç—Ä–æ–∫–
  57              	
  58              	.text
  59              	    movl $4, %eax        # –Ω–æ–º–µ—Ä —Å–∏—Å—Ç. –≤—ã–∑–æ–≤–∞ write
  60              	    movl $1, %ebx        # –ø–∞—Ä–∞–º–µ—Ç—Ä 1: –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –≤—ã–≤
  61              	    movl $str\@, %ecx    # –ø–∞—Ä–∞–º–µ—Ç—Ä 2: –∞–¥—Ä–µ—Å –ø–∞–º—è—Ç–∏ —Å –≤—ã–≤–æ–¥–∏–º—ã–º–∏ —Å–∏
  62              	    movl $strlen\@, %edx     # –ø–∞—Ä–∞–º–µ—Ç—Ä 3: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç–æ–≤ –¥–ª—è –≤—ã–≤–
  63              	    int $0x80        # –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤
  64              	.endm
  10              	
  11              	.data
  12 0000 30       		delta: .byte 0x30	# –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–∑ –∫–æ–¥–∞ —Å–∏–º–≤–æ–ª–∞ –µ
  13 0001 0000     	        summ: .short 0	# –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—É–º–º—ã 
  14 0003 0000     		num_system: .short 0 # –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –Ω–æ–º–µ—Ä–∞ —Å.—Å.
  15 0005 00000000 		count_num: .long 0 # –ö–æ–ª-–≤–æ –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Ü–∏—Ñ—Ä –≤ —Å.—Å.
  16 0009 00000000 		str_len: .long 0 # –ö–æ–ª-–≤–æ —Ü–∏—Ñ—Ä –≤ —á–∏—Å–ª–µ –¥–ª—è –≤—ã–≤–æ–¥–∞
  17 000d 00000000 		flag_minus: .long 0 # –§–ª–∞–≥ –º–∏–Ω—É—Å–∞ —Å—É–º–º—ã
  18              		
  19              	.bss
  20              	        .lcomm c, 1               # –ë—É—Ñ–µ—Ä –¥–ª—è —á—Ç–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Å–∏–º–≤–æ–ª–∞.
  21              	        .lcomm out10, 6           # –ë—É—Ñ–µ—Ä –¥–ª—è –≤—ã–≤–æ–¥–∞.
  22              	        .lcomm n, 1		  # –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—É—â–µ–≥–æ —Å–∏–º–≤–æ
  23              	
  24              	.text
  25              	.global _start
  26              	
  27              	_start:
  28              	
  29              	input:
  30              	        Puts "–í–≤–µ–¥–∏—Ç–µ —Ü–∏—Ñ—Ä—É"
  30              	> .data
  30 0011 D092D0B2 	>  str0:.ascii "–í–≤–µ–¥–∏—Ç–µ —Ü–∏—Ñ—Ä—É\n"
  30      D0B5D0B4 
  30      D0B8D182 
  30      D0B520D1 
  30      86D0B8D1 
  30              	> 
  30              	>  strlen0 =. - str0
  30              	> 
  30              	> .text
  30 0000 B8040000 	>  movl $4,%eax
  30      00
  30 0005 BB010000 	>  movl $1,%ebx
  30      00
  30 000a B9110000 	>  movl $str0,%ecx
  30      00
  30 000f BA1A0000 	>  movl $strlen0,%edx
  30      00
  30 0014 CD80     	>  int $0x80
  31              	
GAS LISTING task4.S 			page 3


  32              	show_prompt:
  33              	        Getchar $c              # –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤ –≤–≤–æ–¥–∞ —Å–∏–º–≤–æ–ª–∞ —Å–æ —Å—Ç–∞–Ω–¥–∞—
  33 0016 B8030000 	>  movl $3,%eax
  33      00
  33 001b BB000000 	>  movl $0,%ebx
  33      00
  33 0020 B9000000 	>  movl $c,%ecx
  33      00
  33              	>  
  33 0025 BA010000 	>  movl $1,%edx
  33      00
  33 002a CD80     	>  int $0x80
  34 002c 83F800   	        Cmpl $0, %eax           # –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª - EOF (–≤–≤–µ–¥–µ–Ω–æ 0 —Å–∏–º–≤–æ–ª–æ–≤) ?
  35 002f 0F843801 	        je stop	                # –î–∞ - –≤—ã–≤–æ–¥ —Å—É–º–º—ã
  35      0000
  36              	
  37 0035 C7050D00 		movl $0, flag_minus # –û–±–Ω–æ–≤–ª—è–µ–º —Ñ–ª–∞–≥ –º–∏–Ω—É—Å–∞
  37      00000000 
  37      0000
  38              		
  39 003f 803D0000 		cmpb $'\n', c           # —ç—Ç–æ —Å–∏–º–≤–æ–ª –ø–µ—Ä–µ–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏ ?
  39      00000A
  40 0046 0F84A300 	        je print_summ_numbers_10   # –¥–∞ - –≤—ã–≤–æ–¥ —Å—É–º–º—ã
  40      0000
  41              	
  42 004c 803D0000 		cmpb $'-', c  # –ï—Å–ª–∏ —á–∏—Å–ª–æ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ
  42      00002D
  43 0053 7435     		je minus_numb
  44              	
  45 0055 803D0000 		cmpb $'9', c            # –∫–æ–¥ –±–æ–ª—å—à–µ –∫–æ–¥–∞ —Å–∏–º–≤–æ–ª–∞ '9' ?
  45      000039
  46 005c 775E     	        ja print_err            # –î–ê - –Ω–∞ –≤—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ
  47 005e 803D0000 	        cmpb $'0', c            # –∫–æ–¥ –º–µ–Ω—å—à–µ –∫–æ–¥–∞ —Å–∏–º–≤–æ–ª–∞ '0' ?
  47      000030
  48 0065 7255     	        jb print_err            # –î–ê - –Ω–∞ –≤—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ
  49              	
  50 0067 A0000000 	        movb c, %al # –ü–µ—Ä–µ–¥–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Å –≤ n
  50      00
  51 006c A20A0000 	        movb %al, n
  51      00
  52              	
  53              	plus_numb:
  54 0071 6631C0   		xorw %ax, %ax		# –û–±–Ω—É–ª–µ–Ω–∏–µ %ax –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
  55              	
  56 0074 A00A0000 	        movb n, %al             # –ü—Ä–∏—Å–≤–∞–µ–≤–∞–µ–º %al –∑–Ω–∞—á–µ–Ω–∏–µ n
  56      00
  57              	
  58 0079 2A050000 		subb delta, %al		# –ü–æ–ª—É—á–∞–µ–º —á–∏—Å–ª–æ –∏–∑ –∫–æ–¥–∞
  58      0000
  59 007f 66010501 		addw %ax, summ		# –ü—Ä–∏–±–∞–≤–ª—è–µ–º —á–∏—Å–ª–æ –∫ —Å—É–º–º–µ
  59      000000
  60 0086 704F     		jo err_buf_over		# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ
  61              	
  62 0088 EB8C     		jmp show_prompt
  63              	
  64              	minus_numb:
  65              		Getchar $c
GAS LISTING task4.S 			page 4


  65 008a B8030000 	>  movl $3,%eax
  65      00
  65 008f BB000000 	>  movl $0,%ebx
  65      00
  65 0094 B9000000 	>  movl $c,%ecx
  65      00
  65              	>  
  65 0099 BA010000 	>  movl $1,%edx
  65      00
  65 009e CD80     	>  int $0x80
  66 00a0 6631C0   		xorw %ax, %ax           # –û–±–Ω—É–ª–µ–Ω–∏–µ %ax –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
  67              	
  68 00a3 A0000000 	        movb c, %al             # –ü—Ä–∏—Å–≤–∞–µ–≤–∞–µ–º %al –∑–Ω–∞—á–µ–Ω–∏–µ c
  68      00
  69              	
  70 00a8 2A050000 	        subb delta, %al         # –ü–æ–ª—É—á–∞–µ–º —á–∏—Å–ª–æ –∏–∑ –∫–æ–¥–∞
  70      0000
  71              	
  72 00ae 66290501 	        subw %ax, summ          # –ü—Ä–∏–±–∞–≤–ª—è–µ–º —á–∏—Å–ª–æ –∫ —Å—É–º–º–µ
  72      000000
  73 00b5 7020     		jo err_buf_over         # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ
  74              	
  75 00b7 E95AFFFF 	        jmp show_prompt
  75      FF
  76              		
  77              	print_err:
  78              		Puts "–ù–µ —Ü–∏—Ñ—Ä–æ–≤–∞—è –∫–ª–∞–≤–∏—à–∞. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –≤–≤–æ–¥"	# –≤—ã–≤–æ–¥ —Å–æ–æ–±—â–µ
  78              	> .data
  78 002b D09DD0B5 	>  str3:.ascii "–ù–µ —Ü–∏—Ñ—Ä–æ–≤–∞—è –∫–ª–∞–≤–∏—à–∞. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –≤–≤–æ–¥\n"
  78      20D186D0 
  78      B8D184D1 
  78      80D0BED0 
  78      B2D0B0D1 
  78              	> 
  78              	>  strlen3 =. - str3
  78              	> 
  78              	> .text
  78 00bc B8040000 	>  movl $4,%eax
  78      00
  78 00c1 BB010000 	>  movl $1,%ebx
  78      00
  78 00c6 B92B0000 	>  movl $str3,%ecx
  78      00
  78 00cb BA420000 	>  movl $strlen3,%edx
  78      00
  78 00d0 CD80     	>  int $0x80
  79 00d2 E93FFFFF 		jmp show_prompt 				# –Ω–∞ –≤–≤–æ–¥ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–∏–º–≤–æ–ª–∞
  79      FF
  80              	
  81              	err_buf_over:	
  82              		Puts "–ü—Ä–æ–∏–∑–æ—à–ª–æ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ. –í—ã—Ö–æ–¥."	# –≤—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ
  82              	> .data
  82 006d D09FD180 	>  str4:.ascii "–ü—Ä–æ–∏–∑–æ—à–ª–æ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ. –í—ã—Ö–æ–¥.\n"
  82      D0BED0B8 
  82      D0B7D0BE 
  82      D188D0BB 
  82      D0BE20D0 
GAS LISTING task4.S 			page 5


  82              	> 
  82              	>  strlen4 =. - str4
  82              	> 
  82              	> .text
  82 00d7 B8040000 	>  movl $4,%eax
  82      00
  82 00dc BB010000 	>  movl $1,%ebx
  82      00
  82 00e1 B96D0000 	>  movl $str4,%ecx
  82      00
  82 00e6 BA390000 	>  movl $strlen4,%edx
  82      00
  82 00eb CD80     	>  int $0x80
  83 00ed EB7E     		jmp stop				# –≤—ã—Ö–æ–¥ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã
  84              	
  85              	print_summ_numbers_10:
  86              		Puts "–°—É–º–º–∞ –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö —á–∏—Å–µ–ª –≤ 10 —Å.—Å.: "
  86              	> .data
  86 00a6 D0A1D183 	>  str5:.ascii "–°—É–º–º–∞ –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö —á–∏—Å–µ–ª –≤ 10 —Å.—Å.: \n"
  86      D0BCD0BC 
  86      D0B020D0 
  86      B2D0B2D0 
  86      B5D0B4D0 
  86              	> 
  86              	>  strlen5 =. - str5
  86              	> 
  86              	> .text
  86 00ef B8040000 	>  movl $4,%eax
  86      00
  86 00f4 BB010000 	>  movl $1,%ebx
  86      00
  86 00f9 B9A60000 	>  movl $str5,%ecx
  86      00
  86 00fe BA380000 	>  movl $strlen5,%edx
  86      00
  86 0103 CD80     	>  int $0x80
  87 0105 66C70503 	        movw $10, num_system  
  87      0000000A 
  87      00
  88 010e 66C70505 		movw $4, count_num
  88      00000004 
  88      00
  89 0117 EB60     		jmp ToString
  90              	
  91              	print_summ_numbers_8:	
  92              		Puts "–°—É–º–º–∞ –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö —á–∏—Å–µ–ª –≤ 8 —Å.—Å.: "
  92              	> .data
  92 00de D0A1D183 	>  str6:.ascii "–°—É–º–º–∞ –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö —á–∏—Å–µ–ª –≤ 8 —Å.—Å.: \n"
  92      D0BCD0BC 
  92      D0B020D0 
  92      B2D0B2D0 
  92      B5D0B4D0 
  92              	> 
  92              	>  strlen6 =. - str6
  92              	> 
  92              	> .text
  92 0119 B8040000 	>  movl $4,%eax
GAS LISTING task4.S 			page 6


  92      00
  92 011e BB010000 	>  movl $1,%ebx
  92      00
  92 0123 B9DE0000 	>  movl $str6,%ecx
  92      00
  92 0128 BA370000 	>  movl $strlen6,%edx
  92      00
  92 012d CD80     	>  int $0x80
  93 012f 66C70503 	        movw $8, num_system
  93      00000008 
  93      00
  94 0138 66C70505 		movw $5, count_num
  94      00000005 
  94      00
  95 0141 EB36     		jmp ToString
  96              	
  97              	print_summ_numbers_2:	
  98              		Puts "–°—É–º–º–∞ –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö —á–∏—Å–µ–ª –≤ 2 —Å.—Å.: "
  98              	> .data
  98 0115 D0A1D183 	>  str7:.ascii "–°—É–º–º–∞ –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö —á–∏—Å–µ–ª –≤ 2 —Å.—Å.: \n"
  98      D0BCD0BC 
  98      D0B020D0 
  98      B2D0B2D0 
  98      B5D0B4D0 
  98              	> 
  98              	>  strlen7 =. - str7
  98              	> 
  98              	> .text
  98 0143 B8040000 	>  movl $4,%eax
  98      00
  98 0148 BB010000 	>  movl $1,%ebx
  98      00
  98 014d B9150100 	>  movl $str7,%ecx
  98      00
  98 0152 BA370000 	>  movl $strlen7,%edx
  98      00
  98 0157 CD80     	>  int $0x80
  99 0159 66C70503 	        movw $2, num_system
  99      00000002 
  99      00
 100 0162 66C70505 		movw $15, count_num
 100      0000000F 
 100      00
 101 016b EB0C     		jmp ToString
 102              	
 103              	stop:
 104              		Exit $0			# –≤—ã—Ö–æ–¥ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã
 104 016d B8010000 	>  movl $1,%eax
 104      00
 104 0172 BB000000 	>  movl $0,%ebx
 104      00
 104 0177 CD80     	>  int $0x80
 105              	
 106              	ToString:
 107 0179 668B1D03 	        movw num_system, %bx    # –°–∏—Å—Ç–µ–º–∞ —Å—á–∏—Å–ª–µ–Ω–∏—è. –ù–∞ –Ω–µ—ë –±—É–¥–µ–º –¥–µ–ª–
 107      000000
 108 0180 8B350500 	        movl count_num, %esi    # –ê–¥—Ä–µ—Å —Å–∞–º–æ–≥–æ –ø–µ—Ä–≤–æ–≥–æ —á–∏–ª–∞. –í —á–∏—Å–ª–µ <=
GAS LISTING task4.S 			page 7


 108      0000
 109 0186 66A10100 	        movw summ, %ax 		# –ö–æ–ø–∏—Ä—É–µ–º –Ω–æ–º–µ—Ä –≤ %ax
 109      0000
 110 018c 31FF     	        xorl %edi, %edi         # –û–±–Ω—É–ª—è–µ–º %edi
 111 018e 31C9     		xorl %ecx, %ecx
 112              	
 113 0190 66833D01 		cmpw $0, summ
 113      00000000 
 114 0198 7C1B     		jl ToStr_begin_minus
 115              		
 116              	ToStr_begin:           # –ù–∞—á–∞–ª–æ —Ü–∏–∫–ª–∞
 117 019a 41       		incl %ecx               # –°—á–µ—Ç—á–∏–∫ –¥–ª–∏–Ω—ã —Å—Ç—Ä–æ–∫–∏ –≤—ã–≤–æ–¥–∞
 118 019b BA000000 	        movl $0, %edx           # –û–±–Ω—É–ª—è–µ–º %edx (–í –Ω—ë–º –ø–æ—Å–ª–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –±—É
 118      00
 119 01a0 66F7F3   	        divw %bx                # –î–µ–ª–∏–º %ax –Ω–∞ %bx, –æ—Å—Ç–∞—Ç–æ–∫ –≤ %dx
 120 01a3 80C230   	        addb $0x30, %dl         # –ü—Ä–∏–±–∞–≤–ª—è–µ–º –∫ %dl 0x30, —á—Ç–æ–±—ã –ø–µ—Ä–µ–π—Ç–∏ –∫ –∫
 121 01a6 88960400 	        movb %dl, out10(%esi) 	# –ö–æ–ø–∏—Ä—É–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ %dl –≤ –±—É—Ñ–µ—Ä –ø–æ –Ω—É–
 121      0000
 122              	
 123 01ac 6683F800 	        cmpw $0, %ax            # –î–æ—à–ª–∏ –¥–æ –Ω—É–ª—è? (–í %ax –ø—É—Å—Ç–æ?)
 124 01b0 741C     	        je some_changes  	# –î–∞, –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏ –≥–æ–æ–≤–∏
 125              	
 126 01b2 4E       	        decl %esi               # –ù–µ—Ç, —É–º–µ–Ω—å—à–∞–µ–º %esi –Ω–∞ 1
 127 01b3 EBE5     	        jmp ToStr_begin     	# –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –Ω–∞—á–∞–ª–æ —Ü–∏–∫–ªa
 128              	
 129              	ToStr_begin_minus:
 130 01b5 C7050D00 		movl $1, flag_minus
 130      00000100 
 130      0000
 131              			
 132 01bf 66F71D01 		negw summ
 132      000000
 133              	
 134 01c6 66A10100 		movw summ, %ax 		# –ö–æ–ø–∏—Ä—É–µ–º –Ω–æ–º–µ—Ä –≤ %ax
 134      0000
 135              		
 136 01cc EBCC     		jmp ToStr_begin
 137              		
 138              		
 139              	some_changes:
 140 01ce FF050500 		incl count_num  # –ü—Ä–∏–±–∞–≤–ª—è–µ–º 1 –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
 140      0000
 141 01d4 890D0900 		movl %ecx, str_len # –°—á–µ—Ç—á–∏–∫ –¥–ª—è –¥–ª–∏–Ω—ã —Å—Ç—Ä–æ–∫–∏ –≤—ã–≤–æ–¥–∞
 141      0000
 142              	
 143              	Pre_out:
 144 01da 833D0D00 		cmpl $1, flag_minus
 144      000001
 145 01e1 741F     		je ToStr_out_minus	
 146              		
 147              	ToStr_out:
 148 01e3 3B350500 	        cmpl count_num, %esi  # –í %esi –º–∞–∫—Å. –∫–æ–ª-–≤–æ —Ü–∏—Ñ—Ä —Å.—Å.? (5 –≤ 10 —Å—Å)
 148      0000
 149 01e9 7434     	        je stop_to_string     # –î–∞, –≤—ã—Ö–æ–¥–∏–º
 150              	
 151 01eb 8A860400 	        movb out10(%esi), %al 	# –ö–æ–ø–∏—Ä—É–µ–º –±–∞–π—Ç –ø–æ –∞–¥—Ä–µ—Å—É  out(%esi) –≤ %al
 151      0000
GAS LISTING task4.S 			page 8


 152 01f1 C6860400 	        movb $0, out10(%esi)  	# –ó–∞–ø–∏—Å—ã–≤–∞–µ–º 0 –ø–æ –∞–¥—Ä–µ—Å—É out(%esi)
 152      000000
 153 01f8 88870400 	        movb %al, out10(%edi) 	# –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ %al –ø–æ –∞–¥—Ä–µ—Å—É out(%e
 153      0000
 154 01fe 46       	        inc %esi                # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º %esi –Ω–∞ 1
 155 01ff 47       	        inc %edi                # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º %edi –Ω–∞ 1
 156 0200 EBE1     	        jmp ToStr_out    	# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –Ω–∞—á–∞–ª–æ —Ü–∏–∫–ª–∞
 157              	
 158              	ToStr_out_minus:
 159 0202 C6870400 		movb $45, out10(%edi) 	# –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –º–∏–Ω—É—Å –ø–æ –∞–¥—Ä–µ—Å—É out(%edi)
 159      00002D
 160 0209 47       		incl %edi
 161 020a 83050900 		addl $1, str_len
 161      000001
 162 0211 EBD0     		jmp ToStr_out                    
 163              	
 164              	neg_summ:
 165 0213 66F71D01 		negw summ
 165      000000
 166 021a E9E1FDFF 		jmp input
 166      FF
 167              		
 168              	stop_to_string:   # –í—ã–≤–æ–¥ —Å—É–º–º—ã
 169 021f B8040000 		movl $4, %eax		# –Ω–æ–º–µ—Ä —Å–∏—Å—Ç. –≤—ã–∑–æ–≤–∞ write
 169      00
 170 0224 BB010000 		movl $1, %ebx		# –ø–∞—Ä–∞–º–µ—Ç—Ä 1: –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞	
 170      00
 171 0229 B9040000 		movl $out10, %ecx	# –ø–∞—Ä–∞–º–µ—Ç—Ä 2: –∞–¥—Ä–µ—Å –ø–∞–º—è—Ç–∏ —Å –≤—ã–≤–æ–¥–∏–º—ã–º–∏ —Å–∏–º–≤–æ
 171      00
 172 022e 8B150900 		movl str_len, %edx        # –ø–∞—Ä–∞–º–µ—Ç—Ä 3: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç–æ–≤ –¥–ª—è –≤—ã–≤–æ–
 172      0000
 173 0234 CD80     		int $0x80		# –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤
 174              		Puts ""
 174              	> .data
 174 014c 0A       	>  str9:.ascii "\n"
 174              	> 
 174              	>  strlen9 =. - str9
 174              	> 
 174              	> .text
 174 0236 B8040000 	>  movl $4,%eax
 174      00
 174 023b BB010000 	>  movl $1,%ebx
 174      00
 174 0240 B94C0100 	>  movl $str9,%ecx
 174      00
 174 0245 BA010000 	>  movl $strlen9,%edx
 174      00
 174 024a CD80     	>  int $0x80
 175 024c 66C70504 		movw $'',out10          # –æ–±–Ω—É–ª—è–µ–º –±—É—Ñ–µ—Ä –≤—ã–≤–æ–¥–∞
 175      00000027 
 175      00
 176              	
 177 0255 66833D03 		cmpw $10, num_system    # –ï—Å–ª–∏ 10 —Å—Å –±—ã–ª–∞, —Ç–æ –∏–¥–µ–º –∫ 8 —Å—Å
 177      0000000A 
 178 025d 0F84B6FE 		je print_summ_numbers_8
 178      FFFF
 179              	
GAS LISTING task4.S 			page 9


 180 0263 66833D03 		cmpw $8, num_system     # –ï—Å–ª–∏ 8 —Å—Å –±—ã–ª–∞, —Ç–æ –∏–¥–µ–º –∫ 2 —Å—Å
 180      00000008 
 181 026b 0F84D2FE 		je print_summ_numbers_2
 181      FFFF
 182              	
 183 0271 833D0D00 		cmpl $1, flag_minus
 183      000001
 184 0278 7499     		je neg_summ
 185              		
 186 027a E981FDFF 		jmp input # –ö –≤–≤–æ–¥—É —Å–ª–µ–¥—É—é—â–µ–≥–æ —á–∏—Å–ª–∞
 186      FF
 187              	
 188              	.end
GAS LISTING task4.S 			page 10


DEFINED SYMBOLS
             task4.S:12     .data:0000000000000000 delta
             task4.S:13     .data:0000000000000001 summ
             task4.S:14     .data:0000000000000003 num_system
             task4.S:15     .data:0000000000000005 count_num
             task4.S:16     .data:0000000000000009 str_len
             task4.S:17     .data:000000000000000d flag_minus
                             .bss:0000000000000000 c
             task4.S:21     .bss:0000000000000004 out10
             task4.S:21     .bss:000000000000000a n
             task4.S:27     .text:0000000000000000 _start
             task4.S:29     .text:0000000000000000 input
             task4.S:30     .data:0000000000000011 str0
             task4.S:30     *ABS*:000000000000001a strlen0
             task4.S:32     .text:0000000000000016 show_prompt
             task4.S:103    .text:000000000000016d stop
             task4.S:85     .text:00000000000000ef print_summ_numbers_10
             task4.S:64     .text:000000000000008a minus_numb
             task4.S:77     .text:00000000000000bc print_err
             task4.S:53     .text:0000000000000071 plus_numb
             task4.S:81     .text:00000000000000d7 err_buf_over
             task4.S:78     .data:000000000000002b str3
             task4.S:78     *ABS*:0000000000000042 strlen3
             task4.S:82     .data:000000000000006d str4
             task4.S:82     *ABS*:0000000000000039 strlen4
             task4.S:86     .data:00000000000000a6 str5
             task4.S:86     *ABS*:0000000000000038 strlen5
             task4.S:106    .text:0000000000000179 ToString
             task4.S:91     .text:0000000000000119 print_summ_numbers_8
             task4.S:92     .data:00000000000000de str6
             task4.S:92     *ABS*:0000000000000037 strlen6
             task4.S:97     .text:0000000000000143 print_summ_numbers_2
             task4.S:98     .data:0000000000000115 str7
             task4.S:98     *ABS*:0000000000000037 strlen7
             task4.S:129    .text:00000000000001b5 ToStr_begin_minus
             task4.S:116    .text:000000000000019a ToStr_begin
             task4.S:139    .text:00000000000001ce some_changes
             task4.S:143    .text:00000000000001da Pre_out
             task4.S:158    .text:0000000000000202 ToStr_out_minus
             task4.S:147    .text:00000000000001e3 ToStr_out
             task4.S:168    .text:000000000000021f stop_to_string
             task4.S:164    .text:0000000000000213 neg_summ
             task4.S:174    .data:000000000000014c str9
             task4.S:174    *ABS*:0000000000000001 strlen9

NO UNDEFINED SYMBOLS
