GAS LISTING task4.S 			page 1


   1              	/* ÐŸÑ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð° Ð´Ð»Ñ Ð²Ð²Ð¾Ð´Ð° Ð¿Ð¾ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸ Ñ†Ð¸Ñ„Ñ€ Ð¸ Ð²Ñ‹Ð²Ð¾Ð´
   2              		
   3              	.include "my-macro" 		# ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ñ„Ð°Ð¹Ð» Ñ Ð¼Ð°ÐºÑ€Ð¾Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸ÑÐ¼Ð¸
   1              	/*
   2              	 * ÐœÐ°ÐºÑ€Ð¾Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹.
   3              	 * ÐÑ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹:
   4              	 *     - ÐºÐ¾Ð´ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ñ‹
   5              	 *
   6              	 * ÐŸÐ¾ÑÐ»Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð¼Ð°ÐºÑ€Ð¾Ð²Ñ‹Ð·Ð¾Ð²Ð° Ð¸Ð·Ð¼ÐµÐ½ÑÑŽÑ‚ÑÑ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ñ‹: %e
   7              	 * Ð¡Ð¼. Ñ‚Ð°ÐºÐ¶Ðµ 'man 2 exit'
   8              	*/
   9              	.macro Exit ret_val
  10              	    movl $1, %eax         # Ð½Ð¾Ð¼ÐµÑ€ ÑÐ¸ÑÑ‚. Ð²Ñ‹Ð·Ð¾Ð²Ð° exit
  11              	    movl \ret_val, %ebx     # ÐºÐ¾Ð´ Ð²Ñ‹Ñ…Ð¾Ð´Ð°
  12              	    int $0x80         # Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ð¹ Ð²Ñ‹Ð·Ð¾Ð²
  13              	.endm
  14              	
  15              	
  16              	/*
  17              	 * ÐœÐ°ÐºÑ€Ð¾Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ ÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ñ Ð¾Ð´Ð½Ð¾Ð³Ð¾ Ð±Ð°Ð¹Ñ‚Ð° ÐºÐ¾Ð´Ð° Ñ
  18              	 * ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½Ð¾Ð³Ð¾ Ð²Ð²Ð¾Ð´Ð°
  19              	 * ÐÑ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹:
  20              	 *     - Ð°Ð´Ñ€ÐµÑ Ð±ÑƒÑ„ÐµÑ€Ð° Ð´Ð»Ñ ÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ñ Ð±Ð°Ð¹Ñ‚Ð°
  21              	 * Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚:
  22              	 *    - Ð² %eax ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÑ‡Ð¸Ñ‚Ð°Ð½Ð½Ñ‹Ñ… Ð±Ð°Ð¹Ñ‚Ð¾Ð²
  23              	 *    - Ð¿Ð¾ Ð°Ð´Ñ€ÐµÑÑƒ buf_addr - ÑÑ‡Ð¸Ñ‚Ð°Ð½Ð½Ñ‹Ð¹ Ð±Ð°Ð¹Ñ‚
  24              	 *
  25              	 * ÐŸÐ¾ÑÐ»Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð¼Ð°ÐºÑ€Ð¾Ð²Ñ‹Ð·Ð¾Ð²Ð° Ð¸Ð·Ð¼ÐµÐ½ÑÑŽÑ‚ÑÑ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ñ‹: %e
  26              	 * Ð¡Ð¼. Ñ‚Ð°ÐºÐ¶Ðµ 'man 2 read'
  27              	*/
  28              	.macro Getchar buf_addr
  29              	    movl $3, %eax        # Ð½Ð¾Ð¼ÐµÑ€ ÑÐ¸ÑÑ‚. Ð²Ñ‹Ð·Ð¾Ð²Ð° read
  30              	    movl $0, %ebx        # Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ 1: Ð´ÐµÑÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ñ€ ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½Ð¾Ð³Ð¾ Ð²Ð²Ð¾
  31              	    movl \buf_addr, %ecx    # Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ 2: Ð°Ð´Ñ€ÐµÑ Ð±ÑƒÑ„ÐµÑ€Ð° (Ð¾Ð½ Ð¶Ðµ - Ñ„Ð°ÐºÑ‚Ð¸Ñ‡
  32              	                     # Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ Ð¼Ð°ÐºÑ€Ð¾Ð²Ñ‹Ð·Ð¾Ð²Ð°)
  33              	    movl $1, %edx        # Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ 3: ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð±Ð°Ð¹Ñ‚Ð¾Ð² Ð´Ð»Ñ Ñ‡Ñ‚ÐµÐ½Ð¸Ñ
  34              	    int $0x80        # Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ð¹ Ð²Ñ‹Ð·Ð¾Ð²
  35              	.endm
  36              	
  37              	/*
  38              	 * ÐœÐ°ÐºÑ€Ð¾Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ  Ð²Ñ‹Ð²Ð¾Ð´Ð° ÑÑ‚Ñ€Ð¾ÐºÐ¸ Ð² Ñ„Ð°Ð¹Ð» ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð
  39              	 * ÐÑ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹:
  40              	 *     - Ð¡Ñ‚Ñ€Ð¾ÐºÐ° Ð´Ð»Ñ Ð²Ñ‹Ð²Ð¾Ð´Ð°.
  41              	 *
  42              	 * ÐŸÑ€Ð¸Ð¼ÐµÑ‚Ñ€ Ð¼Ð°ÐºÑ€Ð¾Ð²Ñ‹Ð·Ð¾Ð²Ð°:
  43              	 *    Puts "Ð¢ÐµÐºÑÑ‚ Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ð¼Ð¾Ð¹ ÑÑ‚Ñ€Ð¾ÐºÐ¸"
  44              	 *
  45              	 * Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚:
  46              	 *    - Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ñ‚ Ð² ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½Ñ‹Ð¹ Ð²Ñ‹Ð²Ð¾Ð´ ÑÐ¸Ð¼Ð²Ð¾Ð»Ñ‹ Ð·Ð°Ð´Ð°Ð½Ð½Ð¾Ð¹ ÑÑ‚Ñ€Ð
  47              	 *      Ð¸ Ð²ÑÐ»ÐµÐ´ Ð·Ð° Ð½Ð¸Ð¼Ð¸ ÑÐ¸Ð¼Ð²Ð¾Ð» Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´Ð° ÑÑ‚Ñ€Ð¾ÐºÐ¸ \n
  48              	 *
  49              	 * ÐŸÐ¾ÑÐ»Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð¼Ð°ÐºÑ€Ð¾Ð²Ñ‹Ð·Ð¾Ð²Ð° Ð¸Ð·Ð¼ÐµÐ½ÑÑŽÑ‚ÑÑ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ñ‹: %e
  50              	 * Ð¡Ð¼. Ñ‚Ð°ÐºÐ¶Ðµ 'man puts', 'man 2 write'
  51              	*/
  52              	.macro Puts string
  53              	.data
  54              	    str\@:     .ascii "\string\n"  # Ñ„Ð¾Ñ€Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ„Ð°ÐºÑ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð¹ ÑÑ‚Ñ€Ð¾ÐºÐ¸ Ð
GAS LISTING task4.S 			page 2


  55              	
  56              	    strlen\@ =     . - str\@           # Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ð´Ð»Ð¸Ð½Ñ‹ ÑÑ‚Ñ€Ð¾ÐºÐ
  57              	
  58              	.text
  59              	    movl $4, %eax        # Ð½Ð¾Ð¼ÐµÑ€ ÑÐ¸ÑÑ‚. Ð²Ñ‹Ð·Ð¾Ð²Ð° write
  60              	    movl $1, %ebx        # Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ 1: Ð´ÐµÑÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ñ€ ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½Ð¾Ð³Ð¾ Ð²Ñ‹Ð²
  61              	    movl $str\@, %ecx    # Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ 2: Ð°Ð´Ñ€ÐµÑ Ð¿Ð°Ð¼ÑÑ‚Ð¸ Ñ Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ð¼Ñ‹Ð¼Ð¸ ÑÐ¸
  62              	    movl $strlen\@, %edx     # Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ 3: ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð±Ð°Ð¹Ñ‚Ð¾Ð² Ð´Ð»Ñ Ð²Ñ‹Ð²Ð
  63              	    int $0x80        # Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ð¹ Ð²Ñ‹Ð·Ð¾Ð²
  64              	.endm
   4              	
   5              	.data
   6 0000 30       		delta: .byte 0x30		# ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð°Ñ Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð¸Ð· ÐºÐ¾Ð´Ð° ÑÐ¸Ð¼Ð²Ð¾Ð»Ð° Ð
   7 0001 0000     		summ: .short 0
   8              	.bss
   9              	        .lcomm c, 1               # Ð‘ÑƒÑ„ÐµÑ€ Ð´Ð»Ñ Ñ‡Ñ‚ÐµÐ½Ð¸Ñ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ³Ð¾ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð°.
  10              	        .lcomm out10, 6           # Ð‘ÑƒÑ„ÐµÑ€ Ð´Ð»Ñ Ð²Ñ‹Ð²Ð¾Ð´Ð°.
  11              	        .lcomm n, 1		  # ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð°Ñ Ð´Ð»Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ³Ð¾ ÑÐ¸Ð¼Ð²Ð¾
  12              	
  13              	.text
  14              	.global _start
  15              	
  16              	_start:
  17              	
  18              	input:
  19              	        Puts "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ñ†Ð¸Ñ„Ñ€Ñƒ"
  19              	> .data
  19 0003 D092D0B2 	>  str0:.ascii "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ñ†Ð¸Ñ„Ñ€Ñƒ\n"
  19      D0B5D0B4 
  19      D0B8D182 
  19      D0B520D1 
  19      86D0B8D1 
  19              	> 
  19              	>  strlen0 =. - str0
  19              	> 
  19              	> .text
  19 0000 B8040000 	>  movl $4,%eax
  19      00
  19 0005 BB010000 	>  movl $1,%ebx
  19      00
  19 000a B9030000 	>  movl $str0,%ecx
  19      00
  19 000f BA1A0000 	>  movl $strlen0,%edx
  19      00
  19 0014 CD80     	>  int $0x80
  20              	
  21              	show_prompt:
  22              	        Getchar $c              # Ð¼Ð°ÐºÑ€Ð¾Ð²Ñ‹Ð·Ð¾Ð² Ð²Ð²Ð¾Ð´Ð° ÑÐ¸Ð¼Ð²Ð¾Ð»Ð° ÑÐ¾ ÑÑ‚Ð°Ð½Ð´Ð°Ñ
  22 0016 B8030000 	>  movl $3,%eax
  22      00
  22 001b BB000000 	>  movl $0,%ebx
  22      00
  22 0020 B9000000 	>  movl $c,%ecx
  22      00
  22              	>  
  22 0025 BA010000 	>  movl $1,%edx
  22      00
GAS LISTING task4.S 			page 3


  22 002a CD80     	>  int $0x80
  23 002c 83F800   	        Cmpl $0, %eax           # ÐšÐ¾Ð½ÐµÑ† Ñ„Ð°Ð¹Ð» - EOF (Ð²Ð²ÐµÐ´ÐµÐ½Ð¾ 0 ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²) ?
  24 002f 0F84B000 	        je print_summ_numbers         # Ð”Ð° - Ð²Ñ‹Ð²Ð¾Ð´ ÑÑƒÐ¼Ð¼Ñ‹
  24      0000
  25              	
  26 0035 803D0000 		cmpb $'\n', c           # ÑÑ‚Ð¾ ÑÐ¸Ð¼Ð²Ð¾Ð» Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´Ð° ÑÑ‚Ñ€Ð¾ÐºÐ¸ ?
  26      00000A
  27 003c 0F84A300 	        je print_summ_numbers   # Ð´Ð° - Ð²Ñ‹Ð²Ð¾Ð´ ÑÑƒÐ¼Ð¼Ñ‹
  27      0000
  28              	
  29 0042 803D0000 		cmpb $'-', c
  29      00002D
  30 0049 7435     		je minus_numb
  31              	
  32 004b 803D0000 		cmpb $'9', c            # ÐºÐ¾Ð´ Ð±Ð¾Ð»ÑŒÑˆÐµ ÐºÐ¾Ð´Ð° ÑÐ¸Ð¼Ð²Ð¾Ð»Ð° '9' ?
  32      000039
  33 0052 775E     	        ja print_err            # Ð”Ð - Ð½Ð° Ð²Ñ‹Ð²Ð¾Ð´ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð¾Ð± Ð¾ÑˆÐ¸Ð±ÐºÐµ
  34 0054 803D0000 	        cmpb $'0', c            # ÐºÐ¾Ð´ Ð¼ÐµÐ½ÑŒÑˆÐµ ÐºÐ¾Ð´Ð° ÑÐ¸Ð¼Ð²Ð¾Ð»Ð° '0' ?
  34      000030
  35 005b 7255     	        jb print_err            # Ð”Ð - Ð½Ð° Ð²Ñ‹Ð²Ð¾Ð´ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð¾Ð± Ð¾ÑˆÐ¸Ð±ÐºÐµ
  36              	
  37 005d A0000000 	        movb c, %al
  37      00
  38 0062 A20A0000 	        movb %al, n
  38      00
  39              	
  40              	plus_numb:
  41 0067 6631C0   		xorw %ax, %ax		# ÐžÐ±Ð½ÑƒÐ»ÐµÐ½Ð¸Ðµ %ax Ð´Ð»Ñ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾Ð¹ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸
  42              	
  43 006a A00A0000 	        movb n, %al             # ÐŸÑ€Ð¸ÑÐ²Ð°ÐµÐ²Ð°ÐµÐ¼ %al Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ n
  43      00
  44              	
  45 006f 2A050000 		subb delta, %al		# ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ñ‡Ð¸ÑÐ»Ð¾ Ð¸Ð· ÐºÐ¾Ð´Ð°
  45      0000
  46 0075 66010501 		addw %ax, summ		# ÐŸÑ€Ð¸Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ñ‡Ð¸ÑÐ»Ð¾ Ðº ÑÑƒÐ¼Ð¼Ðµ
  46      000000
  47 007c 724F     		jc err_buf_over		# ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð½Ð° Ð¿ÐµÑ€ÐµÐ¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ
  48              	
  49 007e EB96     		jmp show_prompt
  50              	
  51              	minus_numb:
  52              		Getchar $c
  52 0080 B8030000 	>  movl $3,%eax
  52      00
  52 0085 BB000000 	>  movl $0,%ebx
  52      00
  52 008a B9000000 	>  movl $c,%ecx
  52      00
  52              	>  
  52 008f BA010000 	>  movl $1,%edx
  52      00
  52 0094 CD80     	>  int $0x80
  53 0096 6631C0   		xorw %ax, %ax           # ÐžÐ±Ð½ÑƒÐ»ÐµÐ½Ð¸Ðµ %ax Ð´Ð»Ñ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾Ð¹ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸
  54              	
  55 0099 A0000000 	        movb c, %al             # ÐŸÑ€Ð¸ÑÐ²Ð°ÐµÐ²Ð°ÐµÐ¼ %al Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ c
  55      00
  56              	
GAS LISTING task4.S 			page 4


  57 009e 2A050000 	        subb delta, %al         # ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ñ‡Ð¸ÑÐ»Ð¾ Ð¸Ð· ÐºÐ¾Ð´Ð°
  57      0000
  58              	
  59 00a4 66290501 	        subw %ax, summ          # ÐŸÑ€Ð¸Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ñ‡Ð¸ÑÐ»Ð¾ Ðº ÑÑƒÐ¼Ð¼Ðµ
  59      000000
  60 00ab 7220     		jc err_buf_over         # ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð½Ð° Ð¿ÐµÑ€ÐµÐ¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ
  61              	
  62 00ad E964FFFF 	        jmp show_prompt
  62      FF
  63              		
  64              	print_err:
  65              		Puts "ÐÐµ Ñ†Ð¸Ñ„Ñ€Ð¾Ð²Ð°Ñ ÐºÐ»Ð°Ð²Ð¸ÑˆÐ°. ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚Ðµ Ð²Ð²Ð¾Ð´"	# Ð²Ñ‹Ð²Ð¾Ð´ ÑÐ¾Ð¾Ð±Ñ‰Ðµ
  65              	> .data
  65 001d D09DD0B5 	>  str3:.ascii "ÐÐµ Ñ†Ð¸Ñ„Ñ€Ð¾Ð²Ð°Ñ ÐºÐ»Ð°Ð²Ð¸ÑˆÐ°. ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚Ðµ Ð²Ð²Ð¾Ð´\n"
  65      20D186D0 
  65      B8D184D1 
  65      80D0BED0 
  65      B2D0B0D1 
  65              	> 
  65              	>  strlen3 =. - str3
  65              	> 
  65              	> .text
  65 00b2 B8040000 	>  movl $4,%eax
  65      00
  65 00b7 BB010000 	>  movl $1,%ebx
  65      00
  65 00bc B91D0000 	>  movl $str3,%ecx
  65      00
  65 00c1 BA420000 	>  movl $strlen3,%edx
  65      00
  65 00c6 CD80     	>  int $0x80
  66 00c8 E949FFFF 		jmp show_prompt 				# Ð½Ð° Ð²Ð²Ð¾Ð´ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÐµÐ³Ð¾ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð°
  66      FF
  67              	
  68              	err_buf_over:	
  69              		Puts "ÐŸÑ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð¾ Ð¿ÐµÑ€ÐµÐ¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ. Ð’Ñ‹Ñ…Ð¾Ð´."	# Ð²Ñ‹Ð²Ð¾Ð´ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð¾
  69              	> .data
  69 005f D09FD180 	>  str4:.ascii "ÐŸÑ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð¾ Ð¿ÐµÑ€ÐµÐ¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ. Ð’Ñ‹Ñ…Ð¾Ð´.\n"
  69      D0BED0B8 
  69      D0B7D0BE 
  69      D188D0BB 
  69      D0BE20D0 
  69              	> 
  69              	>  strlen4 =. - str4
  69              	> 
  69              	> .text
  69 00cd B8040000 	>  movl $4,%eax
  69      00
  69 00d2 BB010000 	>  movl $1,%ebx
  69      00
  69 00d7 B95F0000 	>  movl $str4,%ecx
  69      00
  69 00dc BA390000 	>  movl $strlen4,%edx
  69      00
  69 00e1 CD80     	>  int $0x80
  70 00e3 EB18     		jmp stop				# Ð²Ñ‹Ñ…Ð¾Ð´ Ð¸Ð· Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ñ‹
  71              	
GAS LISTING task4.S 			page 5


  72              	print_summ_numbers:
  73              		Puts "Ð¡ÑƒÐ¼Ð¼Ð° Ð²Ð²ÐµÐ´ÐµÐ½Ð½Ñ‹Ñ… Ñ‡Ð¸ÑÐµÐ»: "
  73              	> .data
  73 0098 D0A1D183 	>  str5:.ascii "Ð¡ÑƒÐ¼Ð¼Ð° Ð²Ð²ÐµÐ´ÐµÐ½Ð½Ñ‹Ñ… Ñ‡Ð¸ÑÐµÐ»: \n"
  73      D0BCD0BC 
  73      D0B020D0 
  73      B2D0B2D0 
  73      B5D0B4D0 
  73              	> 
  73              	>  strlen5 =. - str5
  73              	> 
  73              	> .text
  73 00e5 B8040000 	>  movl $4,%eax
  73      00
  73 00ea BB010000 	>  movl $1,%ebx
  73      00
  73 00ef B9980000 	>  movl $str5,%ecx
  73      00
  73 00f4 BA2B0000 	>  movl $strlen5,%edx
  73      00
  73 00f9 CD80     	>  int $0x80
  74 00fb EB0C     		jmp ToString
  75              	
  76              	stop:
  77              		Exit $0			# Ð²Ñ‹Ñ…Ð¾Ð´ Ð¸Ð· Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ñ‹
  77 00fd B8010000 	>  movl $1,%eax
  77      00
  77 0102 BB000000 	>  movl $0,%ebx
  77      00
  77 0107 CD80     	>  int $0x80
  78              	
  79              	ToString:
  80 0109 66BB0A00 	        movw $10, %bx           # Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° ÑÑ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ñ. ÐÐ° Ð½ÐµÑ‘ Ð±ÑƒÐ´ÐµÐ¼ Ð´ÐµÐ»Ð
  81 010d BE040000 	        movl $4, %esi           # ÐÐ´Ñ€ÐµÑ ÑÐ°Ð¼Ð¾Ð³Ð¾ Ð¿ÐµÑ€Ð²Ð¾Ð³Ð¾ Ñ‡Ð¸Ð»Ð°. Ð’ Ñ‡Ð¸ÑÐ»Ðµ Ð½
  81      00
  82 0112 66A10100 	        movw summ, %ax 		# ÐšÐ¾Ð¿Ð¸Ñ€ÑƒÐµÐ¼ Ð½Ð¾Ð¼ÐµÑ€ Ð² %ax
  82      0000
  83 0118 31FF     	        xorl %edi, %edi         # ÐžÐ±Ð½ÑƒÐ»ÑÐµÐ¼ %edi
  84              	
  85              	ToStr_begin:                  # ÐÐ°Ñ‡Ð°Ð»Ð¾ Ñ†Ð¸ÐºÐ»Ð°
  86 011a BA000000 	        movl $0, %edx           # ÐžÐ±Ð½ÑƒÐ»ÑÐµÐ¼ %edx (Ð’ Ð½Ñ‘Ð¼ Ð¿Ð¾ÑÐ»Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸ Ð±Ñƒ
  86      00
  87 011f 66F7F3   	        divw %bx                # Ð”ÐµÐ»Ð¸Ð¼ %ax Ð½Ð° %bx, Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ðº Ð² %dx
  88 0122 80C230   	        addb $0x30, %dl         # ÐŸÑ€Ð¸Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ðº %dl 0x30, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¿ÐµÑ€ÐµÐ¹Ñ‚Ð¸ Ðº Ðº
  89 0125 88960400 	        movb %dl, out10(%esi) 	# ÐšÐ¾Ð¿Ð¸Ñ€ÑƒÐµÐ¼ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ %dl Ð² Ð±ÑƒÑ„ÐµÑ€ Ð¿Ð¾ Ð½ÑƒÐ
  89      0000
  90              	
  91 012b 6683F800 	        cmpw $0, %ax            # Ð”Ð¾ÑˆÐ»Ð¸ Ð´Ð¾ Ð½ÑƒÐ»Ñ? (Ð’ %ax Ð¿ÑƒÑÑ‚Ð¾?)
  92 012f 7403     	        je ToStr_out     	# Ð”Ð°, Ð·Ð°ÐºÐ°Ð½Ñ‡Ð¸Ð²Ð°ÐµÐ¼ Ð¿Ñ€ÐµÐ¾Ð±Ñ€Ð°Ð·Ð¾Ð²Ð°Ð½Ð¸Ðµ
  93              	
  94 0131 4E       	        decl %esi               # ÐÐµÑ‚, ÑƒÐ¼ÐµÐ½ÑŒÑˆÐ°ÐµÐ¼ %esi Ð½Ð° 1
  95 0132 EBE6     	        jmp ToStr_begin     	# Ð¸ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ð¼ Ð² Ð½Ð°Ñ‡Ð°Ð»Ð¾ Ñ†Ð¸ÐºÐ»Ð°
  96              	
  97              	ToStr_out:
  98 0134 83FE05   	        cmpl  $5, %esi          # Ð’ %esi 5?
  99 0137 7417     	        je stop_to_string     # Ð”Ð°, Ð²Ñ‹Ñ…Ð¾Ð´Ð¸Ð¼
 100              	
GAS LISTING task4.S 			page 6


 101 0139 8A860400 	        movb out10(%esi), %al 	# ÐšÐ¾Ð¿Ð¸Ñ€ÑƒÐµÐ¼ Ð±Ð°Ð¹Ñ‚ Ð¿Ð¾ Ð°Ð´Ñ€ÐµÑÑƒ  out(%esi) Ð² %al
 101      0000
 102 013f C6860400 	        movb $0, out10(%esi)  	# Ð—Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÐ¼ 0 Ð¿Ð¾ Ð°Ð´Ñ€ÐµÑÑƒ out(%esi)
 102      000000
 103 0146 88870400 	        movb %al, out10(%edi) 	# Ð—Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÐ¼ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ %al Ð¿Ð¾ Ð°Ð´Ñ€ÐµÑÑƒ out(%e
 103      0000
 104 014c 46       	        inc %esi                # Ð£Ð²ÐµÐ»Ð¸Ñ‡Ð¸Ð²Ð°ÐµÐ¼ %esi Ð½Ð° 1
 105 014d 47       	        inc %edi                # Ð£Ð²ÐµÐ»Ð¸Ñ‡Ð¸Ð²Ð°ÐµÐ¼ %edi Ð½Ð° 1
 106 014e EBE4     	        jmp ToStr_out    	# ÐŸÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ð¼ Ð² Ð½Ð°Ñ‡Ð°Ð»Ð¾ Ñ†Ð¸ÐºÐ»Ð°
 107              	
 108              	stop_to_string:
 109 0150 B8040000 		movl $4, %eax		# Ð½Ð¾Ð¼ÐµÑ€ ÑÐ¸ÑÑ‚. Ð²Ñ‹Ð·Ð¾Ð²Ð° write
 109      00
 110 0155 BB010000 		movl $1, %ebx		# Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ 1: Ð´ÐµÑÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ñ€ ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½Ð¾Ð³Ð¾ Ð²Ñ‹Ð²Ð¾Ð´Ð°	
 110      00
 111 015a B9040000 		movl $out10, %ecx	# Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ 2: Ð°Ð´Ñ€ÐµÑ Ð¿Ð°Ð¼ÑÑ‚Ð¸ Ñ Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ð¼Ñ‹Ð¼Ð¸ ÑÐ¸Ð¼Ð²Ð¾
 111      00
 112 015f 89F2     		movl %esi, %edx     # Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ 3: ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð±Ð°Ð¹Ñ‚Ð¾Ð² Ð´Ð»Ñ Ð²Ñ‹Ð²Ð¾Ð´Ð°
 113 0161 CD80     		int $0x80		# Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ð¹ Ð²Ñ‹Ð·Ð¾Ð²
 114              		Puts ""
 114              	> .data
 114 00c3 0A       	>  str7:.ascii "\n"
 114              	> 
 114              	>  strlen7 =. - str7
 114              	> 
 114              	> .text
 114 0163 B8040000 	>  movl $4,%eax
 114      00
 114 0168 BB010000 	>  movl $1,%ebx
 114      00
 114 016d B9C30000 	>  movl $str7,%ecx
 114      00
 114 0172 BA010000 	>  movl $strlen7,%edx
 114      00
 114 0177 CD80     	>  int $0x80
 115 0179 66C70504 		movw $'',out10
 115      00000027 
 115      00
 116 0182 E98FFEFF 		jmp show_prompt
 116      FF
 117              	
 118              	.end
GAS LISTING task4.S 			page 7


DEFINED SYMBOLS
             task4.S:6      .data:0000000000000000 delta
             task4.S:7      .data:0000000000000001 summ
                             .bss:0000000000000000 c
             task4.S:10     .bss:0000000000000004 out10
             task4.S:10     .bss:000000000000000a n
             task4.S:16     .text:0000000000000000 _start
             task4.S:18     .text:0000000000000000 input
             task4.S:19     .data:0000000000000003 str0
             task4.S:19     *ABS*:000000000000001a strlen0
             task4.S:21     .text:0000000000000016 show_prompt
             task4.S:72     .text:00000000000000e5 print_summ_numbers
             task4.S:51     .text:0000000000000080 minus_numb
             task4.S:64     .text:00000000000000b2 print_err
             task4.S:40     .text:0000000000000067 plus_numb
             task4.S:68     .text:00000000000000cd err_buf_over
             task4.S:65     .data:000000000000001d str3
             task4.S:65     *ABS*:0000000000000042 strlen3
             task4.S:69     .data:000000000000005f str4
             task4.S:69     *ABS*:0000000000000039 strlen4
             task4.S:76     .text:00000000000000fd stop
             task4.S:73     .data:0000000000000098 str5
             task4.S:73     *ABS*:000000000000002b strlen5
             task4.S:79     .text:0000000000000109 ToString
             task4.S:85     .text:000000000000011a ToStr_begin
             task4.S:97     .text:0000000000000134 ToStr_out
             task4.S:108    .text:0000000000000150 stop_to_string
             task4.S:114    .data:00000000000000c3 str7
             task4.S:114    *ABS*:0000000000000001 strlen7

NO UNDEFINED SYMBOLS
