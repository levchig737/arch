GAS LISTING task4.S 			page 1


   1              	/*
   2              		–ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–ª—è –≤—ã—á–µ—Å–ª–µ–Ω–∏—è —Å—É–º–º—ã –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö –æ–¥–Ω–æ—Ü–∏—Ñ—Ä–æ–≤—
   3              		–¢–∞–∫–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏ –∏ —É—á–∏—Ç—ã–≤–∞–µ—Ç –
   4              		–í—ã–≤–æ–¥–∏—Ç —Å—É–º–º—É —á–∏—Å–µ–ª –≤ 10 —Å—Å 8 —Å—Å –∏ 2 —Å—Å
   5              	
   6              		–ê–≤—Ç–æ—Ä: –ß–µ–∫–∞—Ä–µ–≤ –õ–µ–≤ 22107 2022–≥	
   7              	*/
   8              		
   9              	.include "my-macro" 		# –ü–æ–¥–∫–ª—é—á–∞–µ–º —Ñ–∞–π–ª —Å –º–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è–º–∏
   1              	/*
   2              	 * –ú–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã.
   3              	 * –ê—Ä–≥—É–º–µ–Ω—Ç—ã:
   4              	 *     - –∫–æ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã
   5              	 *
   6              	 * –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞ –∏–∑–º–µ–Ω—è—é—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä—ã: %e
   7              	 * –°–º. —Ç–∞–∫–∂–µ 'man 2 exit'
   8              	*/
   9              	.macro Exit ret_val
  10              	    movl $1, %eax         # –Ω–æ–º–µ—Ä —Å–∏—Å—Ç. –≤—ã–∑–æ–≤–∞ exit
  11              	    movl \ret_val, %ebx     # –∫–æ–¥ –≤—ã—Ö–æ–¥–∞
  12              	    int $0x80         # –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤
  13              	.endm
  14              	
  15              	
  16              	/*
  17              	 * –ú–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–ª—è —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è –æ–¥–Ω–æ–≥–æ –±–∞–π—Ç–∞ –∫–æ–¥–∞ —Å
  18              	 * —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –≤–≤–æ–¥–∞
  19              	 * –ê—Ä–≥—É–º–µ–Ω—Ç—ã:
  20              	 *     - –∞–¥—Ä–µ—Å –±—É—Ñ–µ—Ä–∞ –¥–ª—è —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è –±–∞–π—Ç–∞
  21              	 * –†–µ–∑—É–ª—å—Ç–∞—Ç:
  22              	 *    - –≤ %eax –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—á–∏—Ç–∞–Ω–Ω—ã—Ö –±–∞–π—Ç–æ–≤
  23              	 *    - –ø–æ –∞–¥—Ä–µ—Å—É buf_addr - —Å—á–∏—Ç–∞–Ω–Ω—ã–π –±–∞–π—Ç
  24              	 *
  25              	 * –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞ –∏–∑–º–µ–Ω—è—é—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä—ã: %e
  26              	 * –°–º. —Ç–∞–∫–∂–µ 'man 2 read'
  27              	*/
  28              	.macro Getchar buf_addr
  29              	    movl $3, %eax        # –Ω–æ–º–µ—Ä —Å–∏—Å—Ç. –≤—ã–∑–æ–≤–∞ read
  30              	    movl $0, %ebx        # –ø–∞—Ä–∞–º–µ—Ç—Ä 1: –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –≤–≤–æ
  31              	    movl \buf_addr, %ecx    # –ø–∞—Ä–∞–º–µ—Ç—Ä 2: –∞–¥—Ä–µ—Å –±—É—Ñ–µ—Ä–∞ (–æ–Ω –∂–µ - —Ñ–∞–∫—Ç–∏—á
  32              	                     # –ø–∞—Ä–∞–º–µ—Ç—Ä –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞)
  33              	    movl $1, %edx        # –ø–∞—Ä–∞–º–µ—Ç—Ä 3: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç–æ–≤ –¥–ª—è —á—Ç–µ–Ω–∏—
  34              	    int $0x80        # –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤
  35              	.endm
  36              	
  37              	/*
  38              	 * –ú–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–ª—è  –≤—ã–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏ –≤ —Ñ–∞–π–ª —Å—Ç–∞–Ω–¥–∞—Ä—Ç–
  39              	 * –ê—Ä–≥—É–º–µ–Ω—Ç—ã:
  40              	 *     - –°—Ç—Ä–æ–∫–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞.
  41              	 *
  42              	 * –ü—Ä–∏–º–µ—Ç—Ä –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞:
  43              	 *    Puts "–¢–µ–∫—Å—Ç –≤—ã–≤–æ–¥–∏–º–æ–π —Å—Ç—Ä–æ–∫–∏"
  44              	 *
  45              	 * –†–µ–∑—É–ª—å—Ç–∞—Ç:
  46              	 *    - –≤—ã–≤–æ–¥–∏—Ç –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–≤–æ–¥ —Å–∏–º–≤–æ–ª—ã –∑–∞–¥–∞–Ω–Ω–æ–π —Å—Ç—Ä–
  47              	 *      –∏ –≤—Å–ª–µ–¥ –∑–∞ –Ω–∏–º–∏ —Å–∏–º–≤–æ–ª –ø–µ—Ä–µ–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏ \n
  48              	 *
GAS LISTING task4.S 			page 2


  49              	 * –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞ –∏–∑–º–µ–Ω—è—é—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä—ã: %e
  50              	 * –°–º. —Ç–∞–∫–∂–µ 'man puts', 'man 2 write'
  51              	*/
  52              	.macro Puts string
  53              	.data
  54              	    str\@:     .ascii "\string\n"  # —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä–æ–∫–∏ –
  55              	
  56              	    strlen\@ =     . - str\@           # –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª–∏–Ω—ã —Å—Ç—Ä–æ–∫–
  57              	
  58              	.text
  59              	    movl $4, %eax        # –Ω–æ–º–µ—Ä —Å–∏—Å—Ç. –≤—ã–∑–æ–≤–∞ write
  60              	    movl $1, %ebx        # –ø–∞—Ä–∞–º–µ—Ç—Ä 1: –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –≤—ã–≤
  61              	    movl $str\@, %ecx    # –ø–∞—Ä–∞–º–µ—Ç—Ä 2: –∞–¥—Ä–µ—Å –ø–∞–º—è—Ç–∏ —Å –≤—ã–≤–æ–¥–∏–º—ã–º–∏ —Å–∏
  62              	    movl $strlen\@, %edx     # –ø–∞—Ä–∞–º–µ—Ç—Ä 3: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç–æ–≤ –¥–ª—è –≤—ã–≤–
  63              	    int $0x80        # –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤
  64              	.endm
  10              	
  11              	.data
  12 0000 30       		delta: .byte 0x30	# –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–∑ –∫–æ–¥–∞ —Å–∏–º–≤–æ–ª–∞ –µ
  13 0001 0000     	        summ: .short 0	# –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—É–º–º—ã 
  14 0003 0000     		num_system: .short 0 # –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –Ω–æ–º–µ—Ä–∞ —Å.—Å.
  15 0005 00000000 		count_num: .long 0 # –ö–æ–ª-–≤–æ –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Ü–∏—Ñ—Ä –≤ —Å.—Å.
  16 0009 00000000 		str_len: .long 0 # –ö–æ–ª-–≤–æ —Ü–∏—Ñ—Ä –≤ —á–∏—Å–ª–µ –¥–ª—è –≤—ã–≤–æ–¥–∞ 
  17              		
  18              	.bss
  19              	        .lcomm c, 1               # –ë—É—Ñ–µ—Ä –¥–ª—è —á—Ç–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Å–∏–º–≤–æ–ª–∞.
  20              	        .lcomm out10, 6           # –ë—É—Ñ–µ—Ä –¥–ª—è –≤—ã–≤–æ–¥–∞.
  21              	        .lcomm n, 1		  # –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—É—â–µ–≥–æ —Å–∏–º–≤–æ
  22              	
  23              	.text
  24              	.global _start
  25              	
  26              	_start:
  27              	
  28              	input:
  29              	        Puts "–í–≤–µ–¥–∏—Ç–µ —Ü–∏—Ñ—Ä—É"
  29              	> .data
  29 000d D092D0B2 	>  str0:.ascii "–í–≤–µ–¥–∏—Ç–µ —Ü–∏—Ñ—Ä—É\n"
  29      D0B5D0B4 
  29      D0B8D182 
  29      D0B520D1 
  29      86D0B8D1 
  29              	> 
  29              	>  strlen0 =. - str0
  29              	> 
  29              	> .text
  29 0000 B8040000 	>  movl $4,%eax
  29      00
  29 0005 BB010000 	>  movl $1,%ebx
  29      00
  29 000a B90D0000 	>  movl $str0,%ecx
  29      00
  29 000f BA1A0000 	>  movl $strlen0,%edx
  29      00
  29 0014 CD80     	>  int $0x80
  30              	
  31              	show_prompt:
GAS LISTING task4.S 			page 3


  32              	        Getchar $c              # –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤ –≤–≤–æ–¥–∞ —Å–∏–º–≤–æ–ª–∞ —Å–æ —Å—Ç–∞–Ω–¥–∞—
  32 0016 B8030000 	>  movl $3,%eax
  32      00
  32 001b BB000000 	>  movl $0,%ebx
  32      00
  32 0020 B9000000 	>  movl $c,%ecx
  32      00
  32              	>  
  32 0025 BA010000 	>  movl $1,%edx
  32      00
  32 002a CD80     	>  int $0x80
  33 002c 83F800   	        Cmpl $0, %eax           # –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª - EOF (–≤–≤–µ–¥–µ–Ω–æ 0 —Å–∏–º–≤–æ–ª–æ–≤) ?
  34 002f 0F84B000 	        je print_summ_numbers_10         # –î–∞ - –≤—ã–≤–æ–¥ —Å—É–º–º—ã
  34      0000
  35              	
  36 0035 803D0000 		cmpb $'\n', c           # —ç—Ç–æ —Å–∏–º–≤–æ–ª –ø–µ—Ä–µ–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏ ?
  36      00000A
  37 003c 0F84A300 	        je print_summ_numbers_10   # –¥–∞ - –≤—ã–≤–æ–¥ —Å—É–º–º—ã
  37      0000
  38              	
  39 0042 803D0000 		cmpb $'-', c  # –ï—Å–ª–∏ —á–∏—Å–ª–æ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ
  39      00002D
  40 0049 7435     		je minus_numb
  41              	
  42 004b 803D0000 		cmpb $'9', c            # –∫–æ–¥ –±–æ–ª—å—à–µ –∫–æ–¥–∞ —Å–∏–º–≤–æ–ª–∞ '9' ?
  42      000039
  43 0052 775E     	        ja print_err            # –î–ê - –Ω–∞ –≤—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ
  44 0054 803D0000 	        cmpb $'0', c            # –∫–æ–¥ –º–µ–Ω—å—à–µ –∫–æ–¥–∞ —Å–∏–º–≤–æ–ª–∞ '0' ?
  44      000030
  45 005b 7255     	        jb print_err            # –î–ê - –Ω–∞ –≤—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ
  46              	
  47 005d A0000000 	        movb c, %al # –ü–µ—Ä–µ–¥–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Å –≤ n
  47      00
  48 0062 A20A0000 	        movb %al, n
  48      00
  49              	
  50              	plus_numb:
  51 0067 6631C0   		xorw %ax, %ax		# –û–±–Ω—É–ª–µ–Ω–∏–µ %ax –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
  52              	
  53 006a A00A0000 	        movb n, %al             # –ü—Ä–∏—Å–≤–∞–µ–≤–∞–µ–º %al –∑–Ω–∞—á–µ–Ω–∏–µ n
  53      00
  54              	
  55 006f 2A050000 		subb delta, %al		# –ü–æ–ª—É—á–∞–µ–º —á–∏—Å–ª–æ –∏–∑ –∫–æ–¥–∞
  55      0000
  56 0075 66010501 		addw %ax, summ		# –ü—Ä–∏–±–∞–≤–ª—è–µ–º —á–∏—Å–ª–æ –∫ —Å—É–º–º–µ
  56      000000
  57 007c 724F     		jc err_buf_over		# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ
  58              	
  59 007e EB96     		jmp show_prompt
  60              	
  61              	minus_numb:
  62              		Getchar $c
  62 0080 B8030000 	>  movl $3,%eax
  62      00
  62 0085 BB000000 	>  movl $0,%ebx
  62      00
  62 008a B9000000 	>  movl $c,%ecx
GAS LISTING task4.S 			page 4


  62      00
  62              	>  
  62 008f BA010000 	>  movl $1,%edx
  62      00
  62 0094 CD80     	>  int $0x80
  63 0096 6631C0   		xorw %ax, %ax           # –û–±–Ω—É–ª–µ–Ω–∏–µ %ax –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
  64              	
  65 0099 A0000000 	        movb c, %al             # –ü—Ä–∏—Å–≤–∞–µ–≤–∞–µ–º %al –∑–Ω–∞—á–µ–Ω–∏–µ c
  65      00
  66              	
  67 009e 2A050000 	        subb delta, %al         # –ü–æ–ª—É—á–∞–µ–º —á–∏—Å–ª–æ –∏–∑ –∫–æ–¥–∞
  67      0000
  68              	
  69 00a4 66290501 	        subw %ax, summ          # –ü—Ä–∏–±–∞–≤–ª—è–µ–º —á–∏—Å–ª–æ –∫ —Å—É–º–º–µ
  69      000000
  70 00ab 7220     		jc err_buf_over         # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ
  71              	
  72 00ad E964FFFF 	        jmp show_prompt
  72      FF
  73              		
  74              	print_err:
  75              		Puts "–ù–µ —Ü–∏—Ñ—Ä–æ–≤–∞—è –∫–ª–∞–≤–∏—à–∞. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –≤–≤–æ–¥"	# –≤—ã–≤–æ–¥ —Å–æ–æ–±—â–µ
  75              	> .data
  75 0027 D09DD0B5 	>  str3:.ascii "–ù–µ —Ü–∏—Ñ—Ä–æ–≤–∞—è –∫–ª–∞–≤–∏—à–∞. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –≤–≤–æ–¥\n"
  75      20D186D0 
  75      B8D184D1 
  75      80D0BED0 
  75      B2D0B0D1 
  75              	> 
  75              	>  strlen3 =. - str3
  75              	> 
  75              	> .text
  75 00b2 B8040000 	>  movl $4,%eax
  75      00
  75 00b7 BB010000 	>  movl $1,%ebx
  75      00
  75 00bc B9270000 	>  movl $str3,%ecx
  75      00
  75 00c1 BA420000 	>  movl $strlen3,%edx
  75      00
  75 00c6 CD80     	>  int $0x80
  76 00c8 E949FFFF 		jmp show_prompt 				# –Ω–∞ –≤–≤–æ–¥ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–∏–º–≤–æ–ª–∞
  76      FF
  77              	
  78              	err_buf_over:	
  79              		Puts "–ü—Ä–æ–∏–∑–æ—à–ª–æ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ. –í—ã—Ö–æ–¥."	# –≤—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ
  79              	> .data
  79 0069 D09FD180 	>  str4:.ascii "–ü—Ä–æ–∏–∑–æ—à–ª–æ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ. –í—ã—Ö–æ–¥.\n"
  79      D0BED0B8 
  79      D0B7D0BE 
  79      D188D0BB 
  79      D0BE20D0 
  79              	> 
  79              	>  strlen4 =. - str4
  79              	> 
  79              	> .text
  79 00cd B8040000 	>  movl $4,%eax
GAS LISTING task4.S 			page 5


  79      00
  79 00d2 BB010000 	>  movl $1,%ebx
  79      00
  79 00d7 B9690000 	>  movl $str4,%ecx
  79      00
  79 00dc BA390000 	>  movl $strlen4,%edx
  79      00
  79 00e1 CD80     	>  int $0x80
  80 00e3 EB7E     		jmp stop				# –≤—ã—Ö–æ–¥ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã
  81              	
  82              	print_summ_numbers_10:
  83              		Puts "–°—É–º–º–∞ –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö —á–∏—Å–µ–ª –≤ 10 —Å.—Å.: "
  83              	> .data
  83 00a2 D0A1D183 	>  str5:.ascii "–°—É–º–º–∞ –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö —á–∏—Å–µ–ª –≤ 10 —Å.—Å.: \n"
  83      D0BCD0BC 
  83      D0B020D0 
  83      B2D0B2D0 
  83      B5D0B4D0 
  83              	> 
  83              	>  strlen5 =. - str5
  83              	> 
  83              	> .text
  83 00e5 B8040000 	>  movl $4,%eax
  83      00
  83 00ea BB010000 	>  movl $1,%ebx
  83      00
  83 00ef B9A20000 	>  movl $str5,%ecx
  83      00
  83 00f4 BA380000 	>  movl $strlen5,%edx
  83      00
  83 00f9 CD80     	>  int $0x80
  84 00fb 66C70503 	        movw $10, num_system  
  84      0000000A 
  84      00
  85 0104 66C70505 		movw $4, count_num
  85      00000004 
  85      00
  86 010d EB60     		jmp ToString
  87              	
  88              	print_summ_numbers_8:	
  89              		Puts "–°—É–º–º–∞ –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö —á–∏—Å–µ–ª –≤ 8 —Å.—Å.: "
  89              	> .data
  89 00da D0A1D183 	>  str6:.ascii "–°—É–º–º–∞ –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö —á–∏—Å–µ–ª –≤ 8 —Å.—Å.: \n"
  89      D0BCD0BC 
  89      D0B020D0 
  89      B2D0B2D0 
  89      B5D0B4D0 
  89              	> 
  89              	>  strlen6 =. - str6
  89              	> 
  89              	> .text
  89 010f B8040000 	>  movl $4,%eax
  89      00
  89 0114 BB010000 	>  movl $1,%ebx
  89      00
  89 0119 B9DA0000 	>  movl $str6,%ecx
  89      00
GAS LISTING task4.S 			page 6


  89 011e BA370000 	>  movl $strlen6,%edx
  89      00
  89 0123 CD80     	>  int $0x80
  90 0125 66C70503 	        movw $8, num_system
  90      00000008 
  90      00
  91 012e 66C70505 		movw $5, count_num
  91      00000005 
  91      00
  92 0137 EB36     		jmp ToString
  93              	
  94              	print_summ_numbers_2:	
  95              		Puts "–°—É–º–º–∞ –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö —á–∏—Å–µ–ª –≤ 2 —Å.—Å.: "
  95              	> .data
  95 0111 D0A1D183 	>  str7:.ascii "–°—É–º–º–∞ –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö —á–∏—Å–µ–ª –≤ 2 —Å.—Å.: \n"
  95      D0BCD0BC 
  95      D0B020D0 
  95      B2D0B2D0 
  95      B5D0B4D0 
  95              	> 
  95              	>  strlen7 =. - str7
  95              	> 
  95              	> .text
  95 0139 B8040000 	>  movl $4,%eax
  95      00
  95 013e BB010000 	>  movl $1,%ebx
  95      00
  95 0143 B9110100 	>  movl $str7,%ecx
  95      00
  95 0148 BA370000 	>  movl $strlen7,%edx
  95      00
  95 014d CD80     	>  int $0x80
  96 014f 66C70503 	        movw $2, num_system
  96      00000002 
  96      00
  97 0158 66C70505 		movw $15, count_num
  97      0000000F 
  97      00
  98 0161 EB0C     		jmp ToString
  99              	
 100              	stop:
 101              		Exit $0			# –≤—ã—Ö–æ–¥ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã
 101 0163 B8010000 	>  movl $1,%eax
 101      00
 101 0168 BB000000 	>  movl $0,%ebx
 101      00
 101 016d CD80     	>  int $0x80
 102              	
 103              	ToString:
 104 016f 668B1D03 	        movw num_system, %bx    # –°–∏—Å—Ç–µ–º–∞ —Å—á–∏—Å–ª–µ–Ω–∏—è. –ù–∞ –Ω–µ—ë –±—É–¥–µ–º –¥–µ–ª–
 104      000000
 105 0176 8B350500 	        movl count_num, %esi    # –ê–¥—Ä–µ—Å —Å–∞–º–æ–≥–æ –ø–µ—Ä–≤–æ–≥–æ —á–∏–ª–∞. –í —á–∏—Å–ª–µ <=
 105      0000
 106 017c 66A10100 	        movw summ, %ax 		# –ö–æ–ø–∏—Ä—É–µ–º –Ω–æ–º–µ—Ä –≤ %ax
 106      0000
 107 0182 31FF     	        xorl %edi, %edi         # –û–±–Ω—É–ª—è–µ–º %edi
 108 0184 31C9     		xorl %ecx, %ecx
GAS LISTING task4.S 			page 7


 109              	
 110              	ToStr_begin:           # –ù–∞—á–∞–ª–æ —Ü–∏–∫–ª–∞
 111 0186 41       		incl %ecx               # –°—á–µ—Ç—á–∏–∫ –¥–ª–∏–Ω—ã —Å—Ç—Ä–æ–∫–∏ –≤—ã–≤–æ–¥–∞
 112 0187 BA000000 	        movl $0, %edx           # –û–±–Ω—É–ª—è–µ–º %edx (–í –Ω—ë–º –ø–æ—Å–ª–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –±—É
 112      00
 113 018c 66F7F3   	        divw %bx                # –î–µ–ª–∏–º %ax –Ω–∞ %bx, –æ—Å—Ç–∞—Ç–æ–∫ –≤ %dx
 114 018f 80C230   	        addb $0x30, %dl         # –ü—Ä–∏–±–∞–≤–ª—è–µ–º –∫ %dl 0x30, —á—Ç–æ–±—ã –ø–µ—Ä–µ–π—Ç–∏ –∫ –∫
 115 0192 88960400 	        movb %dl, out10(%esi) 	# –ö–æ–ø–∏—Ä—É–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ %dl –≤ –±—É—Ñ–µ—Ä –ø–æ –Ω—É–
 115      0000
 116              	
 117 0198 6683F800 	        cmpw $0, %ax            # –î–æ—à–ª–∏ –¥–æ –Ω—É–ª—è? (–í %ax –ø—É—Å—Ç–æ?)
 118 019c 7403     	        je some_changes  	# –î–∞, –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏ –≥–æ–æ–≤–∏
 119              	
 120 019e 4E       	        decl %esi               # –ù–µ—Ç, —É–º–µ–Ω—å—à–∞–µ–º %esi –Ω–∞ 1
 121 019f EBE5     	        jmp ToStr_begin     	# –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –Ω–∞—á–∞–ª–æ —Ü–∏–∫–ªa
 122              	
 123              	some_changes:
 124 01a1 FF050500 		incl count_num  # –ü—Ä–∏–±–∞–≤–ª—è–µ–º 1 –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
 124      0000
 125 01a7 890D0900 		movl %ecx, str_len # –°—á–µ—Ç—á–∏–∫ –¥–ª—è –¥–ª–∏–Ω—ã —Å—Ç—Ä–æ–∫–∏ –≤—ã–≤–æ–¥–∞
 125      0000
 126              		
 127              	ToStr_out:
 128 01ad 3B350500 	        cmpl count_num, %esi  # –í %esi –º–∞–∫—Å. –∫–æ–ª-–≤–æ —Ü–∏—Ñ—Ä —Å.—Å.? (5 –≤ 10 —Å—Å)
 128      0000
 129 01b3 7417     	        je stop_to_string     # –î–∞, –≤—ã—Ö–æ–¥–∏–º
 130              	
 131 01b5 8A860400 	        movb out10(%esi), %al 	# –ö–æ–ø–∏—Ä—É–µ–º –±–∞–π—Ç –ø–æ –∞–¥—Ä–µ—Å—É  out(%esi) –≤ %al
 131      0000
 132 01bb C6860400 	        movb $0, out10(%esi)  	# –ó–∞–ø–∏—Å—ã–≤–∞–µ–º 0 –ø–æ –∞–¥—Ä–µ—Å—É out(%esi)
 132      000000
 133 01c2 88870400 	        movb %al, out10(%edi) 	# –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ %al –ø–æ –∞–¥—Ä–µ—Å—É out(%e
 133      0000
 134 01c8 46       	        inc %esi                # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º %esi –Ω–∞ 1
 135 01c9 47       	        inc %edi                # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º %edi –Ω–∞ 1
 136 01ca EBE1     	        jmp ToStr_out    	# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –Ω–∞—á–∞–ª–æ —Ü–∏–∫–ª–∞
 137              	
 138              	stop_to_string:   # –í—ã–≤–æ–¥ —Å—É–º–º—ã
 139 01cc B8040000 		movl $4, %eax		# –Ω–æ–º–µ—Ä —Å–∏—Å—Ç. –≤—ã–∑–æ–≤–∞ write
 139      00
 140 01d1 BB010000 		movl $1, %ebx		# –ø–∞—Ä–∞–º–µ—Ç—Ä 1: –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞	
 140      00
 141 01d6 B9040000 		movl $out10, %ecx	# –ø–∞—Ä–∞–º–µ—Ç—Ä 2: –∞–¥—Ä–µ—Å –ø–∞–º—è—Ç–∏ —Å –≤—ã–≤–æ–¥–∏–º—ã–º–∏ —Å–∏–º–≤–æ
 141      00
 142 01db 8B150900 		movl str_len, %edx        # –ø–∞—Ä–∞–º–µ—Ç—Ä 3: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç–æ–≤ –¥–ª—è –≤—ã–≤–æ–
 142      0000
 143 01e1 CD80     		int $0x80		# –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤
 144              		Puts ""
 144              	> .data
 144 0148 0A       	>  str9:.ascii "\n"
 144              	> 
 144              	>  strlen9 =. - str9
 144              	> 
 144              	> .text
 144 01e3 B8040000 	>  movl $4,%eax
 144      00
 144 01e8 BB010000 	>  movl $1,%ebx
GAS LISTING task4.S 			page 8


 144      00
 144 01ed B9480100 	>  movl $str9,%ecx
 144      00
 144 01f2 BA010000 	>  movl $strlen9,%edx
 144      00
 144 01f7 CD80     	>  int $0x80
 145 01f9 66C70504 		movw $'',out10          # –æ–±–Ω—É–ª—è–µ–º –±—É—Ñ–µ—Ä –≤—ã–≤–æ–¥–∞
 145      00000027 
 145      00
 146              	
 147 0202 66833D03 		cmpw $10, num_system    # –ï—Å–ª–∏ 10 —Å—Å –±—ã–ª–∞, —Ç–æ –∏–¥–µ–º –∫ 8 —Å—Å
 147      0000000A 
 148 020a 0F84FFFE 		je print_summ_numbers_8
 148      FFFF
 149              	
 150 0210 66833D03 		cmpw $8, num_system     # –ï—Å–ª–∏ 8 —Å—Å –±—ã–ª–∞, —Ç–æ –∏–¥–µ–º –∫ 2 —Å—Å
 150      00000008 
 151 0218 0F841BFF 		je print_summ_numbers_2
 151      FFFF
 152              		
 153 021e E9DDFDFF 		jmp input # –ö –≤–≤–æ–¥—É —Å–ª–µ–¥—É—é—â–µ–≥–æ —á–∏—Å–ª–∞
 153      FF
 154              	
 155              	.end
GAS LISTING task4.S 			page 9


DEFINED SYMBOLS
             task4.S:12     .data:0000000000000000 delta
             task4.S:13     .data:0000000000000001 summ
             task4.S:14     .data:0000000000000003 num_system
             task4.S:15     .data:0000000000000005 count_num
             task4.S:16     .data:0000000000000009 str_len
                             .bss:0000000000000000 c
             task4.S:20     .bss:0000000000000004 out10
             task4.S:20     .bss:000000000000000a n
             task4.S:26     .text:0000000000000000 _start
             task4.S:28     .text:0000000000000000 input
             task4.S:29     .data:000000000000000d str0
             task4.S:29     *ABS*:000000000000001a strlen0
             task4.S:31     .text:0000000000000016 show_prompt
             task4.S:82     .text:00000000000000e5 print_summ_numbers_10
             task4.S:61     .text:0000000000000080 minus_numb
             task4.S:74     .text:00000000000000b2 print_err
             task4.S:50     .text:0000000000000067 plus_numb
             task4.S:78     .text:00000000000000cd err_buf_over
             task4.S:75     .data:0000000000000027 str3
             task4.S:75     *ABS*:0000000000000042 strlen3
             task4.S:79     .data:0000000000000069 str4
             task4.S:79     *ABS*:0000000000000039 strlen4
             task4.S:100    .text:0000000000000163 stop
             task4.S:83     .data:00000000000000a2 str5
             task4.S:83     *ABS*:0000000000000038 strlen5
             task4.S:103    .text:000000000000016f ToString
             task4.S:88     .text:000000000000010f print_summ_numbers_8
             task4.S:89     .data:00000000000000da str6
             task4.S:89     *ABS*:0000000000000037 strlen6
             task4.S:94     .text:0000000000000139 print_summ_numbers_2
             task4.S:95     .data:0000000000000111 str7
             task4.S:95     *ABS*:0000000000000037 strlen7
             task4.S:110    .text:0000000000000186 ToStr_begin
             task4.S:123    .text:00000000000001a1 some_changes
             task4.S:127    .text:00000000000001ad ToStr_out
             task4.S:138    .text:00000000000001cc stop_to_string
             task4.S:144    .data:0000000000000148 str9
             task4.S:144    *ABS*:0000000000000001 strlen9

NO UNDEFINED SYMBOLS
